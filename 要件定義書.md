# **AIジャーナル生成アプリ 要件定義書 (Draft 1.0)**

## **1\. プロジェクト概要**

ユーザーの1日の行動（開始・終了・内容・タグ・気分など）を記録し、Google Gemini APIを用いて解析・ジャーナル化するWebアプリケーション。個人の生産性向上（A）、メンタルヘルス管理（B）、ライフログ（C）を目的とする。

## **2\. システムアーキテクチャ方針**

* **フロントエンド:** React (Single Page Application)  
  * 高速なUI操作と状態管理のため。  
* **データストア:** Google Drive (JSONファイル)  
  * **保存形式:** YYYY-MM-DD.json （1日1ファイル、または月単位フォルダ）  
  * **データ構造:** **イベントストリーム形式**（後述）。時系列に追記していくログ形式を採用。  
* **AI解析:** Google Gemini API  
  * 生ログデータを整形し、要約・評価・アドバイスを生成する。  
* **認証:** Google Identity Services (OAuth 2.0)  
  * Driveへのアクセス権限取得のため。

## **3\. 機能要件**

### **3.1 入力機能 (Data Entry)**

コンセプト: 「イベント」として記録する。  
ユーザーの操作は「タスク開始」と「タスク終了」の2アクションを基本とするが、データ上は独立したログとして扱う。

* **アクション:**  
  * **開始 (Start):** タイトル、タグ、開始時刻を記録。UUID（ユニークID）を発行し、セッションを開始。  
  * **終了 (End):** 対応するUUIDを指定し、終了時刻、詳細/備考、タスクの進捗度(%表記)、完了時の気分（評価）を記録。  
  * **単発記録 (One-shot):** 開始・終了を同時入力、または瞬間のメモ（時刻のみ）。  
* **UI挙動:**  
  * 現在進行中のタスク（Start済み・End未）をUI上で「アクティブ」として表示する。  
  * タグは履歴からサジェスト、またはプリセット選択。  
  * 時刻はデフォルトで現在時刻だが、編集可能（後から入力対応）。

### **3.2 データ保存・管理 (Storage)**

Google Drive上のJSONファイルに対し、配列としてオブジェクトを追記（Append）していく。

**JSONデータ構造案 (イベントストリーム形式):**

\[  
  {  
    "eventId": "uuid-1",  
    "type": "START",  
    "timestamp": "2026-01-20T09:00:00+09:00",  
    "activityName": "コーディング",  
    "tags": \["Dev", "ProjectA"\]  
  },  
  {  
    "eventId": "uuid-2",  
    "type": "MEMO",  
    "timestamp": "2026-01-20T10:30:00+09:00",  
    "content": "良いアイデアを思いついた..."  
  },  
  {  
    "refEventId": "uuid-1",   
    "type": "END",  
    "timestamp": "2026-01-20T12:00:00+09:00",  
    "description": "認証周りの実装完了",  
    "moodScore": 4   
  }  
\]

* refEventId: 終了イベントが、どの開始イベントに対応するかを紐付けるキー。これにより解析時に時間を計算する。

### **3.3 データ解析・ジャーナル生成 (Analysis)**

Gemini APIにJSONデータを渡し、以下の観点で解析を行う。

* **前処理:** STARTとENDを紐付け、各タスクの所要時間を算出する。完了していないタスクがある場合は「未完了」として扱う。  
* **優先順位に基づく出力:**  
  1. **生産性評価 (Priority A):**  
     * 時間対効果の分析。  
     * 「集中できていた時間帯」と「間延びした時間帯」の特定。  
     * タグごとの合計時間集計。  
  2. **メンタルヘルス・感情分析 (Priority B):**  
     * moodScoreが高い/低い活動の傾向分析。  
     * 「何をしている時が幸せか」のフィードバック。  
  3. **ライフログ・事実要約 (Priority C):**  
     * 1日のタイムラインの文章化（日記形式）。  
* **出力形式:** UI表示用のMarkdownテキストおよび、グラフ描画用の集計JSONデータ。

### **3.4 可視化 (Visualization)**

AI解析結果とは別に、アプリ側で定量データをグラフ化する。

* **円グラフ:** タグ別・プロジェクト別の時間配分（今日の時間の使い方）。  
* **タイムラインチャート:** ガントチャート風の表示（いつ何をしたか）。  
* **推移グラフ (週間レビュー用):** 特定タグ（例: "学習"）の投下時間推移。

## **4\. 非機能要件**

* **プライバシー:** データはユーザー個人のGoogle Driveにのみ保存され、開発者側のサーバーには保存されない。  
* **レスポンス:** 入力から保存までのラグを最小限にし、UIをブロックしない（Optimistic UIの検討）。  
* **モバイル対応:** スマートフォンブラウザでの操作を考慮したレスポンシブデザイン。

## **5\. 開発フェーズ計画 (案)**

1. **フェーズ1 (プロトタイプ):** Googleログイン、DriveへのJSON保存/読込、単純なStart/End記録の実装。  
2. **フェーズ2 (可視化):** 記録データのタイムライン表示、タグ集計グラフの実装。  
3. **フェーズ3 (AI統合):** Gemini APIを組み込み、ボタン1つで「今日の振り返り」を生成する機能の実装。